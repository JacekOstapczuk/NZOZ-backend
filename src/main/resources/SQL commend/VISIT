CREATE TABLE VISIT_AUD
(
    EVENT_ID   INT(11)  NOT NULL AUTO_INCREMENT,
    EVENT_DATE DATETIME NOT NULL,
    EVENT_TYPE VARCHAR(10) DEFAULT NULL,
    OLD_VISIT_ID INT(11),
    NEW_VISIT_ID INT(11),
    OLD_PHYSICIAN_ID INT(11),
    NEW_PHYSICIAN_ID INT(11),
    OLD_PATIENT_ID INT(11),
    NEW_PATIENT_ID INT(11),
    OLD_OUTPOST_ID INT(11),
    NEW_OUTPOST_ID INT(11),
    OLD_DATE DATETIME,
    NEW_DATE DATETIME,

    PRIMARY KEY (EVENT_ID)
);


DELIMITER $$

CREATE TRIGGER VISIT_INSERT AFTER INSERT ON VISITS
    FOR EACH ROW
BEGIN
    INSERT INTO VISIT_AUD (  EVENT_DATE, EVENT_TYPE, NEW_VISIT_ID,  NEW_PHYSICIAN_ID, NEW_PATIENT_ID, NEW_OUTPOST_ID ,  NEW_DATE)
        VALUE(CURTIME(), 'INSERT', NEW.ID,  NEW.PHYSICIAN_ID, NEW.PATIENT_ID, NEW.OUTPOST_ID ,  NEW.DATE );
END $$

DELIMITER ;

DELIMITER $$

CREATE TRIGGER VISIT_DELETE AFTER DELETE ON VISITS
    FOR EACH ROW
BEGIN
    INSERT INTO VISIT_AUD (  EVENT_DATE, EVENT_TYPE, OLD_VISIT_ID,  OLD_PHYSICIAN_ID, OLD_PATIENT_ID, OLD_OUTPOST_ID ,  OLD_DATE)
        VALUE(CURTIME(), 'INSERT', OLD.ID,  OLD.PHYSICIAN_ID, OLD.PATIENT_ID, OLD.OUTPOST_ID , OLD.DATE );
END $$

DELIMITER ;

DELIMITER $$

CREATE TRIGGER VISIT_UPDATE AFTER UPDATE ON VISITS
    FOR EACH ROW
BEGIN
    INSERT INTO VISIT_AUD (  EVENT_DATE, EVENT_TYPE, NEW_VISIT_ID,  NEW_PHYSICIAN_ID, NEW_PATIENT_ID, NEW_OUTPOST_ID ,NEW_DATE,
        OLD_VISIT_ID,  OLD_PHYSICIAN_ID, OLD_PATIENT_ID, OLD_OUTPOST_ID ,  OLD_DATE )
        VALUE(CURTIME(), 'UPDATE', OLD.ID,  OLD.PHYSICIAN_ID, OLD.PATIENT_ID, OLD.OUTPOST_ID , OLD.DATE,
        OLD.ID,  OLD.PHYSICIAN_ID, OLD.PATIENT_ID, OLD.OUTPOST_ID , OLD.DATE );
END $$

DELIMITER ;